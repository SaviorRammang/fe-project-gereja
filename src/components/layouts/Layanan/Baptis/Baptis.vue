<template>
  <!-- Blog Page Title & Breadcrumbs -->
  <div data-aos="fade" class="page-title">
    <div class="heading bg-dark">
      <div class="container mt-5">
        <div class="row d-flex justify-content-center text-center">
          <div class="col-lg-8">
            <h1 class="text-white">Pendaftaran Layanan Baptis</h1>
          </div>
        </div>
      </div>
    </div>
    <nav class="breadcrumbs">
      <div class="container">
        <ol>
          <li><router-link to="/">Home</router-link></li>
          <li class="current">Baptis</li>
        </ol>
      </div>
    </nav>
  </div>
  <!-- End Page Title -->

  <div class="container my-5">
    <div class="row g-5">
      <div class="col-md-6 d-flex justify-content-center">
        <iframe
          width="400"
          height="315"
          src="https://www.youtube.com/embed/uouEtfkNIOo"
        >
        </iframe>
      </div>
      <div class="col-md-6" style="text-align: justify">
        <p>
          Baptis dalam agama Kristen adalah sakramen atau upacara keagamaan yang
          melambangkan penerimaan seseorang ke dalam iman Kristen dan gereja.
          Sakramen ini dilakukan dengan cara mencelupkan atau menuangkan air ke
          atas kepala seseorang sebagai tanda pembersihan dosa dan kelahiran
          baru dalam Kristus. Baptisan dianggap sebagai tanda masuk ke dalam
          persekutuan umat Kristen dan penerimaan anugerah keselamatan dari
          Allah. Ada beberapa aspek penting tentang baptis dalam agama Kristen:
          Simbol Pembersihan Dosa: Baptis melambangkan pembersihan dosa dan
          pembaruan hidup. Dalam upacara ini, air digunakan sebagai simbol
          pembersihan spiritual, mencerminkan pertobatan dan penerimaan
          pengampunan dari Tuhan. Pernyataan Iman: Baptis merupakan pernyataan
          iman seseorang kepada Yesus Kristus sebagai Tuhan dan Juru Selamat.
          Ini adalah tindakan publik yang menunjukkan komitmen seseorang untuk
          mengikuti ajaran Kristus dan hidup sesuai dengan kehendak-Nya. Masuk
          ke dalam Gereja: Melalui baptis, seseorang diterima sebagai anggota
          gereja dan persekutuan umat Kristen. Ini menandai penerimaan individu
          ke dalam keluarga rohani yang lebih besar dan partisipasi dalam
          kehidupan gerejawi. Mengikuti Perintah Kristus: Baptis dilakukan
          sebagai ketaatan terhadap perintah Yesus Kristus, yang dalam Injil
          Matius 28:19-20, memerintahkan murid-murid-Nya untuk membaptis semua
          bangsa dalam nama Bapa, Anak, dan Roh Kudus. Makna Teologis: Baptis
          juga memiliki makna teologis yang mendalam, seperti partisipasi dalam
          kematian dan kebangkitan Kristus. Melalui baptis, orang Kristen
          percaya bahwa mereka turut mati terhadap dosa dan bangkit dalam
          kehidupan baru bersama Kristus (Roma 6:3-4).
        </p>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <div class="row gy-4 d-flex justify-content-center">
      <div class="col-lg-8" data-aos="fade-up" data-aos-delay="200">
        <div class="accordion accordion-flush" id="accordionFlushExample">
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingOne">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseOne"
                aria-expanded="false"
                aria-controls="flush-collapseOne"
              >
                Apa itu baptis dalam agama Kristen ?
              </button>
            </h2>
            <div
              id="flush-collapseOne"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingOne"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Baptis adalah sakramen atau ritus inisiasi dalam agama Kristen
                yang melibatkan penggunaan air untuk melambangkan pembersihan
                dosa, kelahiran baru, dan masuknya seseorang ke dalam komunitas
                gereja. Baptis dilakukan atas perintah Yesus Kristus dan
                dianggap sebagai tanda ketaatan dan iman kepada-Nya.
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingTwo">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseTwo"
                aria-expanded="false"
                aria-controls="flush-collapseTwo"
              >
                Apakah Baptis Hanya Dapat Dilakukan Sekali ?
              </button>
            </h2>
            <div
              id="flush-collapseTwo"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingTwo"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Ya, dalam sebagian besar tradisi Kristen, baptis dianggap
                sebagai sakramen yang hanya dilakukan sekali seumur hidup. Ini
                karena baptis dilihat sebagai tindakan yang mengubah status
                spiritual seseorang secara permanen, menjadikannya anggota penuh
                dalam komunitas iman Kristen.
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingThree">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseThree"
                aria-expanded="false"
                aria-controls="flush-collapseThree"
              >
                Mengapa baptis begitu penting dalam kehidupan Kristen?
              </button>
            </h2>
            <div
              id="flush-collapseThree"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingThree"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Baptis dianggap penting dalam kehidupan Kristen karena merupakan
                tanda perjanjian dengan Allah dan masuk ke dalam komunitas
                gereja Kristen. Baptis juga dianggap sebagai tanda pengampunan
                dosa dan penerimaan kasih karunia Allah, serta sebagai langkah
                pertama dalam perjalanan iman yang mengikatkan seseorang dengan
                Kristus. Selain itu, baptis juga menandai pemisahan dari dosa
                asal dan keterikatan dengan Kristus yang memberikan harapan akan
                kehidupan kekal. Oleh karena itu, baptis dianggap sebagai
                langkah penting dalam perjalanan rohani seseorang dalam iman
                Kristen.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <a
      :href="PDF_URL + 'download-file?jenis=Baptis'"
      class="btn btn-danger mt-3 mb-5"
      target="_blank"
      >Download File Kosong</a
    >

    <form @submit.prevent="pendaftaranLayanan" class="row g-5">
      <input type="hidden" name="user_id" v-model="data.user_id" />
      <div class="col-md-6 col-sm-12">
        <div class="mb-4">
          <label for="jenis" class="form-label fw-bold">Jenis Baptis</label>
          <input
            type="text"
            class="form-control"
            name="jenis"
            v-model="data.jenis"
            readonly
            disabled
          />
        </div>
        <div class="mb-4">
          <label for="pendeta_id" class="form-label fw-bold">Pendeta</label>
          <select
            class="form-select"
            name="pendeta_id"
            aria-label="Pendeta"
            required
            v-model="data.pendeta_id"
            readonly
          >
            <option value="">Pilih Pendeta</option>
            <option
              v-for="(pendeta, index) in pendetas"
              :key="index"
              :value="pendeta.id"
            >
              {{ pendeta.name }}
            </option>
          </select>
        </div>
        <div class="mb-4">
          <label for="nama" class="form-label fw-bold">Nama</label>
          <input
            type="text"
            class="form-control"
            name="nama"
            id="nama"
            required
            v-model="data.nama"
          />
        </div>
        <div class="mb-4">
          <label for="tanggal_lahir" class="form-label fw-bold"
            >Tanggal Lahir</label
          >
          <input
            type="date"
            class="form-control"
            name="tanggal_lahir"
            id="tanggal_lahir"
            required
            v-model="data.tanggal_lahir"
          />
        </div>
        <div class="mb-4">
          <label for="tempat_lahir" class="form-label fw-bold"
            >Tempat Lahir</label
          >
          <input
            type="text"
            class="form-control"
            name="tempat_lahir"
            id="tempat_lahir"
            required
            v-model="data.tempat_lahir"
          />
        </div>
        <div class="mb-4">
          <label for="nama_ayah" class="form-label fw-bold">Nama Ayah</label>
          <input
            type="text"
            class="form-control"
            name="nama_ayah"
            id="nama_ayah"
            required
            v-model="data.nama_ayah"
          />
        </div>
      </div>
      <div class="col-md-6 col-sm-12">
        <div class="mb-4">
          <label for="nama_ibu" class="form-label fw-bold">Nama Ibu</label>
          <input
            type="text"
            class="form-control"
            name="nama_ibu"
            id="nama_ibu"
            required
            v-model="data.nama_ibu"
          />
        </div>
        <div class="mb-4">
          <label for="alamat" class="form-label fw-bold">Alamat</label>
          <input
            type="text"
            class="form-control"
            name="alamat"
            id="alamat"
            required
            v-model="data.alamat"
          />
        </div>
        <div class="mb-4">
          <label for="tanggal" class="form-label fw-bold"
            >Tanggal Mendaftar</label
          >
          <input
            type="date"
            class="form-control"
            name="tanggal"
            id="tanggal"
            :min="today"
            required
            v-model="data.tanggal"
          />
        </div>
        <div class="mb-4">
          <p style="font-weight: bold">Persyaratan :</p>
          <ul>
            <li>1. Surat Nikah Orang Tua.</li>
            <li>2. Akte Kelahiran.</li>
            <li>3. Administrasi Rp 100.000,-</li>
            <li>
              4. Semua persyaratan dimasukkan pada saat pengembalian dilakukan
              selambat-lambatnya 1 hari sebelum pembabtisan pada jam 10.00 pagi.
            </li>
          </ul>
        </div>
      </div>
      <div class="col-12 d-flex justify-content-end">
        <button
          type="submit"
          class="btn btn-danger daftar"
          :disabled="isSubmitting"
        >
          Daftar
        </button>
      </div>
    </form>
  </div>
  <!-- End Blog Section -->
</template>
<script>
import { ref } from "vue";
import axios from "axios";
import moment from "moment";
import jQuery from "jquery";
import CryptoJS from "crypto-js";

const $ = jQuery;
window.$ = $;

const URL_BACKEND = import.meta.env.VITE_URL_BACKEND;
const PDF_URL = import.meta.env.VITE_PDF_URL;

export default {
  data() {
    return {
      pendetas: ref([]),
      data: {
        user_id: "",
        jenis: "Baptis",
        pendeta_id: "",
        nama: "",
        tanggal_lahir: "",
        tempat_lahir: "",
        nama_ayah: "",
        nama_ibu: "",
        alamat: "",
        kondisi_baptis: "Jemaat GKI Kasih Perumnas",
        tempat_kondisi: "Klasis Sorong",
        tanggal: "",
      },
      isSubmitting: false,
      PDF_URL,
    };
  },

  computed: {
    today() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, "0");
      const day = String(today.getDate()).padStart(2, "0");
      return `${year}-${month}-${day}`;
    },
  },

  mounted() {
    axios.get(`${URL_BACKEND}/get-pendeta`).then((response) => {
      console.log(response.data.data);
      this.pendetas = response.data.data;
    });
  },

  methods: {
    pendaftaranLayanan() {
      this.isSubmitting = true;
      $(".daftar").html("Loading...");

      const token = localStorage.getItem("token");
      var bytes = CryptoJS.AES.decrypt(token, "my_very_secret_key_12345");
      var decryptedData = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));

      this.data.user_id = decryptedData[0].id;

      console.log(this.data);

      axios
        .post(`${URL_BACKEND}/create-pendaftaran`, this.data)
        .then((response) => {
          console.log(response.data);
          if (response.data.status === "success") {
            alert(response.data.message);
            this.$router.push("/layanan-saya").then(() => {
              window.location.reload();
            });
          } else {
            this.isSubmitting = false;
            $(".daftar").html("Daftar");
            alert("Gagal mendaftar!");
          }
        })
        .catch((error) => {
          console.log(error);
        });
    },
  },
};
</script>
<style></style>
