<template>
  <!-- Blog Page Title & Breadcrumbs -->
  <div data-aos="fade" class="page-title">
    <div class="heading bg-dark">
      <div class="container mt-5">
        <div class="row d-flex justify-content-center text-center">
          <div class="col-lg-8">
            <h1 class="text-white">Pendaftaran Layanan Katekisasi</h1>
          </div>
        </div>
      </div>
    </div>
    <nav class="breadcrumbs">
      <div class="container">
        <ol>
          <li><router-link to="/">Home</router-link></li>
          <li class="current">Katekisasi</li>
        </ol>
      </div>
    </nav>
  </div>
  <!-- End Page Title -->

  <div class="container my-5">
    <div class="row g-5">
      <div class="col-md-6 d-flex justify-content-center">
        <iframe
          width="400"
          height="315"
          src="https://www.youtube.com/embed/d0reP-wiJYw"
        >
        </iframe>
      </div>
      <div class="col-md-6" style="text-align: justify">
        <p>
          Katekisasi adalah masa sebelum seorang umat Kristiani menerima
          baptisan. Pada masa ini, seorang umat mendapat bimbingan-bimbingan
          yang mendasar mengenai Kekristenan oleh pemimpin agamanya (biasanya
          seorang Pendeta atau Pastor). Katekisasi merupakan bentuk pembinaan
          iman dalam [gereja] yang memiliki latar belakang sejarah sangat kuat
          dalam tradisi keagamaan orang Israel dalam perjanjian lama maupun
          dalam hidup jemaat mula-mula di perjanjian baru. Katekisasi atau
          Katekese berasal dari kata kerja bahasa Yunani Κατεχειν (katekhein),
          yang berarti memberitakan, memberitahukan, mengajar, dan memberi
          pengajaran. Dalam perjanjian baru misalnya, Lukas 1:4, Kisah Para
          Rasul 18:25, 21:21, 24, Roma 2:17-18,1 Korintus 14-19,dan Galatia 6:6.
          Disimpulkan bahwa arti kata Katekhein lebih ditekankan pada mengajar
          bukan dalam arti intelektualistis tetapi lebih kepada arti praktis,
          yaitu mengajar atau membimbing seseorang, supaya ia melakukan apa yang
          diajarkan kepadanya. Katekisasi yang berlangsung dalam gereja berarti,
          kegiatan pengajaran iman yang membimbing seseorang (atau beberapa)
          agar ia melakukan apa yang diajarkan kepadanya. Katekisasi tidak
          semata-mata melakukan transfer pengetahuan Alkitab, melainkan lebih
          menekankan pada upaya menyampaikan pemahaman isi Alkitab. Oleh karena
          itu, katekisasi yang dilakukan gereja adalah kegiatan pengajaran yang
          penting tentang iman juga merupakan pembentukan iman dari peserta
          katekisasi (katekumen/katekisan atau calon warga sidi jemaat),
          sehingga melalui katekisasi warga gereja dilengkapi untuk mengenal dan
          percaya kepada Allah dalam Yesus Kristus sehingga sanggup menghayati,
          mentaati dan melaksanakan imannya dalam keluarga, gereja dan
          masyarakat (Efesus 4: 12-13).
        </p>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <div class="row gy-4 d-flex justify-content-center">
      <div class="col-lg-8" data-aos="fade-up" data-aos-delay="200">
        <div class="accordion accordion-flush" id="accordionFlushExample">
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingOne">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseOne"
                aria-expanded="false"
                aria-controls="flush-collapseOne"
              >
                Apa itu katekisasi ?
              </button>
            </h2>
            <div
              id="flush-collapseOne"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingOne"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Katekisasi merupakan bentuk pembinaan iman dalam gereja yang
                memiliki latar belakang sejarah sangat kuat dalam tradisi
                keagamaan orang Israel dalam perjanjian lama maupun dalam hidup
                jemaat mula-mula di perjanjian baru.
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingTwo">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseTwo"
                aria-expanded="false"
                aria-controls="flush-collapseTwo"
              >
                Apa saja yang diajarkan dalam Katekisasi ?
              </button>
            </h2>
            <div
              id="flush-collapseTwo"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingTwo"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Materi yang diajarkan dalam katekisasi mencakup dasar-dasar iman
                Kristen, termasuk pengajaran tentang Allah Tritunggal: Bapa,
                Anak, dan Roh Kudus, kehidupan dan ajaran Yesus Kristus, Alkitab
                sebagai Firman Allah, serta pemahaman tentang dosa dan
                keselamatan.
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header" id="flush-headingThree">
              <button
                class="accordion-button collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#flush-collapseThree"
                aria-expanded="false"
                aria-controls="flush-collapseThree"
              >
                Mengapa kita harus ikut katekisasi ?
              </button>
            </h2>
            <div
              id="flush-collapseThree"
              class="accordion-collapse collapse"
              aria-labelledby="flush-headingThree"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body" style="text-align: justify">
                Mengikuti katekisasi memiliki sejumlah alasan penting yang
                mendukung pertumbuhan dan pemahaman iman Kristen seseorang.
                Katekisasi memberikan dasar yang kuat dalam iman Kristen.
                Melalui proses ini, individu belajar tentang ajaran-ajaran dasar
                Kristen, termasuk pemahaman tentang Allah, Yesus Kristus, Roh
                Kudus, Alkitab, dan sakramen-sakramen gereja. Pengetahuan ini
                penting agar seseorang dapat memahami dan menghayati iman mereka
                dengan benar.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <div class="row mb-5">
      <div class="col-md-4">
        <select
          class="form-select"
          @change="changeJenis($event)"
          name="jenis"
          aria-label="Jenis Sidi"
          required
          v-model="jenis_download"
        >
          <option value="Katekisasi Reguler">Katekisasi Reguler</option>
          <option value="Katekisasi Dewasa">Katekisasi Dewasa</option>
        </select>
      </div>
      <div class="col-md-2">
        <a
          :href="PDF_URL + 'download-file?jenis=' + jenis_download"
          class="btn btn-danger"
          target="_blank"
          >Download File Kosong</a
        >
      </div>
    </div>

    <form @submit.prevent="pendaftaranLayanan" class="row g-5">
      <input type="hidden" name="user_id" v-model="data.user_id" />
      <div class="col-md-6 col-sm-12">
        <div class="mb-4">
          <label for="jenis" class="form-label fw-bold">Jenis Katekisasi</label>
          <select
            class="form-select"
            name="jenis"
            aria-label="Jenis Katekisasi"
            required
            v-model="data.jenis"
          >
            <option value="">Pilih Jenis Katekisasi</option>
            <option value="Katekisasi Reguler">Katekisasi Reguler</option>
            <option value="Katekisasi Dewasa">Katekisasi Dewasa</option>
          </select>
        </div>
        <div class="mb-4">
          <label for="pendeta_id" class="form-label fw-bold"
            >Dibaptis Oleh Pendeta</label
          >
          <select
            class="form-select"
            name="pendeta_id"
            aria-label="Pendeta"
            required
            v-model="data.pendeta_id"
          >
            <option value="">Pilih Pendeta</option>
            <option
              v-for="(pendeta, index) in pendetas"
              :key="index"
              :value="pendeta.id"
            >
              {{ pendeta.name }}
            </option>
          </select>
        </div>
        <div class="mb-4">
          <label for="nama" class="form-label fw-bold">Nama Lengkap</label>
          <input
            type="text"
            class="form-control"
            name="nama"
            id="nama"
            required
            v-model="data.nama"
          />
        </div>
        <div class="mb-4">
          <label for="tanggal_lahir" class="form-label fw-bold"
            >Tanggal Lahir</label
          >
          <input
            type="date"
            class="form-control"
            name="tanggal_lahir"
            id="tanggal_lahir"
            required
            v-model="data.tanggal_lahir"
          />
        </div>
        <div class="mb-4">
          <label for="tempat_lahir" class="form-label fw-bold"
            >Tempat Lahir</label
          >
          <input
            type="text"
            class="form-control"
            name="tempat_lahir"
            id="tempat_lahir"
            required
            v-model="data.tempat_lahir"
          />
        </div>
        <div class="mb-4">
          <label for="nama_ayah" class="form-label fw-bold">Nama Ayah</label>
          <input
            type="text"
            class="form-control"
            name="nama_ayah"
            id="nama_ayah"
            required
            v-model="data.nama_ayah"
          />
        </div>
      </div>
      <div class="col-md-6 col-sm-12">
        <div class="mb-4">
          <label for="nama_ibu" class="form-label fw-bold">Nama Ibu</label>
          <input
            type="text"
            class="form-control"
            name="nama_ibu"
            id="nama_ibu"
            required
            v-model="data.nama_ibu"
          />
        </div>
        <div class="mb-4">
          <label for="alamat" class="form-label fw-bold">Alamat</label>
          <input
            type="text"
            class="form-control"
            name="alamat"
            id="alamat"
            required
            v-model="data.alamat"
          />
        </div>
        <div class="mb-4">
          <label for="tanggal" class="form-label fw-bold"
            >Tanggal Mendaftar</label
          >
          <input
            type="date"
            class="form-control"
            name="tanggal"
            id="tanggal"
            :min="today"
            required
            v-model="data.tanggal"
          />
        </div>
        <div class="mb-4">
          <p style="font-weight: bold">Persyaratan :</p>
          <ul>
            <li>1. Foto copy Surat Baptis 1 Lembar.</li>
            <li>2. Foto copy Akte Kelahiran 1 Lembar.</li>
            <li>
              3. Persyaratan dimasukan ke dalam MAP berwarna BIRU (Regular).
            </li>
          </ul>
        </div>
      </div>
      <div class="col-12 d-flex justify-content-end">
        <button
          type="submit"
          class="btn btn-danger daftar"
          :disabled="isSubmitting"
        >
          Daftar
        </button>
      </div>
    </form>
  </div>
  <!-- End Blog Section -->
</template>
<script>
import { ref } from "vue";
import axios from "axios";
import moment from "moment";
import jQuery from "jquery";
import CryptoJS from "crypto-js";

const $ = jQuery;
window.$ = $;

const URL_BACKEND = import.meta.env.VITE_URL_BACKEND;
const PDF_URL = import.meta.env.VITE_PDF_URL;

export default {
  data() {
    return {
      pendetas: ref([]),
      data: {
        user_id: "",
        jenis: "",
        pendeta_id: "",
        nama: "",
        tanggal_lahir: "",
        tempat_lahir: "",
        nama_ayah: "",
        nama_ibu: "",
        alamat: "",
        kondisi_baptis: "Jemaat GKI Kasih Perumnas",
        tempat_kondisi: "Klasis Sorong",
        tanggal: "",
      },
      isSubmitting: false,
      PDF_URL,
      jenis_download: "Katekisasi Reguler",
    };
  },

  computed: {
    today() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, "0");
      const day = String(today.getDate()).padStart(2, "0");
      return `${year}-${month}-${day}`;
    },
  },

  mounted() {
    axios.get(`${URL_BACKEND}/get-pendeta`).then((response) => {
      console.log(response.data.data);
      this.pendetas = response.data.data;
    });
  },
  methods: {
    pendaftaranLayanan() {
      this.isSubmitting = true;
      $(".daftar").html("Loading...");

      const token = localStorage.getItem("token");
      var bytes = CryptoJS.AES.decrypt(token, "my_very_secret_key_12345");
      var decryptedData = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));

      this.data.user_id = decryptedData[0].id;

      console.log(this.data);

      axios
        .post(`${URL_BACKEND}/create-pendaftaran`, this.data)
        .then((response) => {
          console.log(response.data);
          if (response.data.status === "success") {
            alert(response.data.message);
            this.$router.push("/layanan-saya").then(() => {
              window.location.reload();
            });
          } else {
            this.isSubmitting = false;
            $(".daftar").html("Daftar");
            alert("Gagal mendaftar!");
          }
        })
        .catch((error) => {
          console.log(error);
        });
    },

    changeJenis(event) {
      this.jenis_download = event.target.value;
    },
  },
};
</script>
<style></style>
